<!DOCTYPE html>
<html>
<head>
    <title>ç½‘ç»œè¿æ¥æµ‹è¯•</title>
    <meta charset="UTF-8">
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test { margin: 10px 0; padding: 10px; border: 1px solid #ccc; }
        .success { background: #d4edda; }
        .error { background: #f8d7da; }
        .info { background: #d1ecf1; }
    </style>
</head>
<body>
    <h1>ğŸ” API_Server ç½‘ç»œè¿æ¥è¯Šæ–­</h1>
    
    <div class="test info">
        <h3>åŸºæœ¬ä¿¡æ¯</h3>
        <p>å½“å‰è®¿é—®åœ°å€: <span id="currentUrl"></span></p>
        <p>ç”¨æˆ·ä»£ç†: <span id="userAgent"></span></p>
        <p>æ—¶é—´: <span id="currentTime"></span></p>
    </div>

    <div class="test" id="apiTest">
        <h3>API è¿æ¥æµ‹è¯•</h3>
        <p>çŠ¶æ€: <span id="apiStatus">æµ‹è¯•ä¸­...</span></p>
        <p>å“åº”: <span id="apiResponse"></span></p>
    </div>

    <div class="test" id="faviconTest">
        <h3>Favicon åŠ è½½æµ‹è¯•</h3>
        <p>çŠ¶æ€: <span id="faviconStatus">æµ‹è¯•ä¸­...</span></p>
        <img src="/favicon.ico" style="width: 16px; height: 16px;" onload="faviconLoaded()" onerror="faviconError()">
    </div>

    <div class="test" id="staticTest">
        <h3>é™æ€èµ„æºæµ‹è¯•</h3>
        <p>çŠ¶æ€: <span id="staticStatus">æµ‹è¯•ä¸­...</span></p>
    </div>

    <div class="test info">
        <h3>ç½‘ç»œå»ºè®®</h3>
        <ul>
            <li>ç¡®ä¿è®¾å¤‡åœ¨åŒä¸€å±€åŸŸç½‘ (10.55.131.x)</li>
            <li>æ£€æŸ¥ä¼ä¸šé˜²ç«å¢™è®¾ç½®</li>
            <li>å°è¯•ç¦ç”¨æµè§ˆå™¨æ‰©å±•</li>
            <li>æ¸…é™¤æµè§ˆå™¨ç¼“å­˜</li>
        </ul>
    </div>

    <script>
        // æ˜¾ç¤ºåŸºæœ¬ä¿¡æ¯
        document.getElementById('currentUrl').textContent = window.location.href;
        document.getElementById('userAgent').textContent = navigator.userAgent;
        document.getElementById('currentTime').textContent = new Date().toLocaleString();

        // æµ‹è¯• API è¿æ¥
        fetch('/api/health')
            .then(response => response.json())
            .then(data => {
                document.getElementById('apiStatus').textContent = 'âœ… æˆåŠŸ';
                document.getElementById('apiResponse').textContent = JSON.stringify(data);
                document.getElementById('apiTest').className = 'test success';
            })
            .catch(error => {
                document.getElementById('apiStatus').textContent = 'âŒ å¤±è´¥';
                document.getElementById('apiResponse').textContent = error.message;
                document.getElementById('apiTest').className = 'test error';
            });

        // Favicon æµ‹è¯•å‡½æ•°
        function faviconLoaded() {
            document.getElementById('faviconStatus').textContent = 'âœ… æˆåŠŸ';
            document.getElementById('faviconTest').className = 'test success';
        }

        function faviconError() {
            document.getElementById('faviconStatus').textContent = 'âŒ å¤±è´¥';
            document.getElementById('faviconTest').className = 'test error';
        }

        // æµ‹è¯•é™æ€èµ„æº
        const testImg = new Image();
        testImg.onload = function() {
            document.getElementById('staticStatus').textContent = 'âœ… CSS åŠ è½½æˆåŠŸ';
            document.getElementById('staticTest').className = 'test success';
        };
        testImg.onerror = function() {
            document.getElementById('staticStatus').textContent = 'âŒ é™æ€èµ„æºåŠ è½½å¤±è´¥';
            document.getElementById('staticTest').className = 'test error';
        };
        
        // å°è¯•åŠ è½½ä¸€ä¸ªå°çš„ CSS æ–‡ä»¶æ¥æµ‹è¯•
        const link = document.createElement('link');
        link.rel = 'stylesheet';
        link.href = '/assets/monaco-editor-C0ykYQ3K.css';
        link.onload = function() {
            document.getElementById('staticStatus').textContent = 'âœ… é™æ€èµ„æºåŠ è½½æˆåŠŸ';
            document.getElementById('staticTest').className = 'test success';
        };
        link.onerror = function() {
            document.getElementById('staticStatus').textContent = 'âŒ é™æ€èµ„æºåŠ è½½å¤±è´¥';
            document.getElementById('staticTest').className = 'test error';
        };
        document.head.appendChild(link);

        // 5ç§’åå¦‚æœè¿˜åœ¨æµ‹è¯•çŠ¶æ€ï¼Œæ ‡è®°ä¸ºè¶…æ—¶
        setTimeout(() => {
            if (document.getElementById('faviconStatus').textContent === 'æµ‹è¯•ä¸­...') {
                document.getElementById('faviconStatus').textContent = 'â° è¶…æ—¶';
                document.getElementById('faviconTest').className = 'test error';
            }
            if (document.getElementById('staticStatus').textContent === 'æµ‹è¯•ä¸­...') {
                document.getElementById('staticStatus').textContent = 'â° è¶…æ—¶';
                document.getElementById('staticTest').className = 'test error';
            }
        }, 5000);
    </script>
</body>
</html>
